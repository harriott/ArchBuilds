# vim: fdm=expr ft=sh.shfold sw=2:

# Joseph Harriott
# Bash configurations that are also useful in Console and as root.
# To be sourced by the parent  ~/.bashrc


alias b='batman'
alias mo='moar'

#=> colours
source $ARCHBUILDS/Bash/xcol.sh

#==> tput foreground
# inspired by nachoparker
export tpfn=$'\e[0m' # normal
export tpfb=$(tput bold)

#===> normal colours
export tpf0=$(tput setaf 0) # black
export tpf1=$(tput setaf 1) # red
export tpf2=$(tput setaf 2) # green
export tpf3=$(tput setaf 3) # yellow
export tpf4=$(tput setaf 4) # blue
export tpf5=$(tput setaf 5) # magenta
export tpf6=$(tput setaf 6) # cyan
export tpf7=$(tput setaf 7) # white
# echo "${tpf0}black ${tpf1}red ${tpf2}green ${tpf3}yellow ${tpf4}blue ${tpf5}magenta ${tpf6}cyan ${tpf7}white${tpfn}"

#===> bold colours
export tpf0b="$tpfb$tpf0" # bold black
export tpf1b="$tpfb$tpf1" # bold red
export tpf2b="$tpfb$tpf2" # bold green
export tpf3b="$tpfb$tpf3" # bold yellow
export tpf4b="$tpfb$tpf4" # bold blue
export tpf5b="$tpfb$tpf5" # bold magenta
export tpf6b="$tpfb$tpf6" # bold cyan
export tpf7b="$tpfb$tpf7" # bold white
# echo "${tpf0b}black ${tpf1b}red ${tpf2b}green ${tpf3b}yellow ${tpf4b}blue ${tpf5b}magenta ${tpf6b}cyan ${tpf7b}white${tpfn}"

#=> command history
alias h='history'
export HISTCONTROL=ignoreboth:erasedups
export HISTIGNORE='?:??'
PROMPT_COMMAND='history -a' # Samokovarov's  jump  later tweaks this
shopt -s histappend

#=> internetish
alias css='cht.sh --shell'
alias p='ping -c 3 8.8.8.8'
alias pg='ping -c 3 -n google.com'
alias pqs='pacman -Qs'
alias wp='curl wttr.in/Paris'  # weather

#=> better file managing
alias e='exa'
alias l='ls --color=auto'
alias s="stat -c '%A %a %h %U %G %s %y %n'"
alias so="stat -c '%a %n'"
alias sm="stat -c '%y %n'"

shopt -s autocd dotglob extglob globstar nullglob

#==> broot
if [ -s "/usr/bin/broot" ]; then
    if [ -s "/usr/bin/moar" ]; then
      export PAGER=moar
    else
      export PAGER=less
    fi

    # generalised from what broot added to .bashrc:
    source ~/.config/broot/launcher/bash/br
fi

#==> count filetypes
cft(){
  find . -path './.git' -prune -o -type f -name "*" | rev | cut -d . -f1 | rev | sort | uniq -ic | sort -rn''
}

#==> fzf
if [ -s "/usr/share/fzf" ]; then
  # alias f="fzf --preview 'bat --color=always {} | head -500'"
  alias f="fzf --preview 'bat --color=always {}'"
  export FZF_DEFAULT_COMMAND='fd --type f --hidden --exclude .git'
  export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
  source /usr/share/fzf/key-bindings.bash
  source /usr/share/fzf/completion.bash
fi

#==> locate directories
locd () {
    locate $1 | xargs -I {} bash -c 'if [ -d "{}" ]; then echo {}; fi'
}

#==> move up [n] directories
up(){
  local dir=""
  limit=$1
  for ((i=1 ; i <= limit ; i++))
    do
      dir=$dir/..
    done
  dir=$(echo $dir | sed 's/^\///')
  if [ -z "$dir" ]; then
    dir=..
  fi
  cd $dir
}

#==> system monitoring
alias bt='bashtop'
alias gl='glances'

#==> virtualenvwrapper
export WORKON_HOME=~/.virtualenvs
[[ -f /usr/bin/virtualenvwrapper.sh ]] && source /usr/bin/virtualenvwrapper.sh

