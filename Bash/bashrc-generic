# vim: fdm=expr fdc=1 ft=sh.shfold sw=2:

# Joseph Harriott
# Bash configurations that are also useful in Console and as root.
# To be sourced by the parent  ~/.bashrc


alias b='batman'
alias mo='moar'

#=> colours
source $ARCHBUILDS/Bash/xcol.sh

#==> nachoparker
#normal=$(tput sgr0)                      # normal text
normal=$'\e[0m'                           # (works better sometimes)
bold=$(tput bold)                         # make colors bold/bright
red="$bold$(tput setaf 1)"                # bright red text
green=$(tput setaf 2)                     # dim green text
fawn=$(tput setaf 3); beige="$fawn"       # dark yellow text
yellow="$bold$fawn"                       # bright yellow text
darkblue=$(tput setaf 4)                  # dim blue text
blue="$bold$darkblue"                     # bright blue text
purple=$(tput setaf 5); magenta="$purple" # magenta text
pink="$bold$purple"                       # bright magenta text
darkcyan=$(tput setaf 6)                  # dim cyan text
cyan="$bold$darkcyan"                     # bright cyan text
gray=$(tput setaf 7)                      # dim white text
darkgray="$bold"$(tput setaf 0)           # bold black = dark gray text
white="$bold$gray"                        # bright white text

#=> command history
alias h='history'
export HISTCONTROL=ignoreboth:erasedups
export HISTIGNORE='?:??'
PROMPT_COMMAND='history -a' # Samokovarov's  jump  later tweaks this
shopt -s histappend

#=> internetish
alias p='ping -c 3 8.8.8.8'
alias pg='ping -c 3 -n google.com'
alias pqs='pacman -Qs'
alias wp='curl wttr.in/Paris'  # weather

#=> better file managing
alias e='exa'
alias l='ls --color=auto'
alias s="stat -c '%A %a %h %U %G %s %y %n'"
alias so="stat -c '%a %n'"
alias sm="stat -c '%y %n'"

shopt -s autocd dotglob extglob globstar nullglob

#==> broot
if [ -s "/usr/bin/broot" ]; then
    if [ -s "/usr/bin/moar" ]; then
      export PAGER=moar
    else
      export PAGER=less
    fi

    # generalised from what broot added to .bashrc:
    source ~/.config/broot/launcher/bash/br
fi

#==> count filetypes
cft(){
  find . -path './.git' -prune -o -type f -name "*" | rev | cut -d . -f1 | rev | sort | uniq -ic | sort -rn''
}

#==> fzf
if [ -s "/usr/share/fzf" ]; then
    # alias f="fzf --preview 'bat --color=always {} | head -500'"
    alias f="fzf --preview 'bat --color=always {}'"
    source /usr/share/fzf/key-bindings.bash
    source /usr/share/fzf/completion.bash
fi

#==> locate directories
locd () {
    locate $1 | xargs -I {} bash -c 'if [ -d "{}" ]; then echo {}; fi'
}

#==> move up [n] directories
up(){
  local dir=""
  limit=$1
  for ((i=1 ; i <= limit ; i++))
    do
      dir=$dir/..
    done
  dir=$(echo $dir | sed 's/^\///')
  if [ -z "$dir" ]; then
    dir=..
  fi
  cd $dir
}

#==> system monitoring
alias bt='bashtop'
alias gl='glances'

#==> virtualenvwrapper
export WORKON_HOME=~/.virtualenvs
[[ -f /usr/bin/virtualenvwrapper.sh ]] && source /usr/bin/virtualenvwrapper.sh

